<app-card>
  @let details = feature();
  <app-card-header [name]="details?.name || ''" [description]="details?.description || ''"  />

  @if (!isEditing()) {
    <div class="w-full max-w-2xl mx-auto mb-4">
      <ul class="mode-radio-group">
        <li class="mode-item">
          <div class="mode-block">
            <input id="horizontal-list-radio-license" type="radio" value="create" name="list-radio" class="mode-input" [(ngModel)]="conversationMode">
            <label for="horizontal-list-radio-license" class="mode-label">Create </label>
          </div>
        </li>
        <li class="mode-item">
          <div class="mode-block">
            <input id="horizontal-list-radio-id" type="radio" value="edit" name="list-radio" class="mode-input" [(ngModel)]="conversationMode">
            <label for="horizontal-list-radio-id" class="mode-label">Edit </label>
          </div>
        </li>
      </ul>
      @if (conversationMode() === 'create') {
        <app-prompt-form
          [(prompt)]="editedPrompt"
          [isLoading]="isLoading()"
          (generate)="handleGenerate($event)"
        >
          <span button-text>{{ details.buttonText }}</span>
          <span loading-text>{{ details.loadingText }}</span>
        </app-prompt-form>
      } @else {
        <app-dropzone #dropzone mode='single' (filesChanged)="imageFiles.set($event)" />
      }
    </div>
  }

  <div class="w-full max-w-2xl mx-auto mb-4 flex justify-end">
    <button
        type="button"
        [disabled]="isConversationDisabled()"
        (click)="toggleConversation()"
        class="px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:bg-indigo-400 disabled:cursor-not-allowed transition duration-200">
        <span>{{ btnConversationText() }}</span>
    </button>
  </div>

  <div class="w-full max-w-2xl mx-auto mb-8 h-[70vh] flex flex-col bg-gray-800 border border-gray-700 rounded-xl shadow-2xl">
    <app-conversation-messages
      class="flex-grow p-6 space-y-6 overflow-y-auto"
      [messages]="messages()"
      [isLoading]="isLoading()"
      (downloadImage)="handleDownloadImage($event)"
    />
    <app-conversation-input-form
      [pauseSendPrompt]="!isEditing() || isLoading()"
      [isGeneratingImage]="isLoading()"
      (newEditRequest)="handleSendPrompt($event)"
    />
  </div>
</app-card>
